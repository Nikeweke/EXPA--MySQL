(window.webpackJsonp=window.webpackJsonp||[]).push([[7],{164:function(s,t,a){"use strict";a.r(t);var n=a(0),r=Object(n.a)({},function(){this.$createElement;this._self._c;return this._m(0)},[function(){var s=this,t=s.$createElement,a=s._self._c||t;return a("div",{staticClass:"content"},[a("h1",{attrs:{id:"transaction"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#transaction","aria-hidden":"true"}},[s._v("#")]),s._v(" TRANSACTION")]),s._v(" "),a("h6",{attrs:{id:"удаnение-записей"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#удаnение-записей","aria-hidden":"true"}},[s._v("#")]),s._v(" Удаление записей")]),s._v(" "),a("div",{staticClass:"language-sql extra-class"},[a("pre",{pre:!0,attrs:{class:"language-sql"}},[a("code",[a("span",{attrs:{class:"token keyword"}},[s._v("BEGIN")]),s._v(" "),a("span",{attrs:{class:"token keyword"}},[s._v("TRANSACTION")]),s._v(" "),a("span",{attrs:{class:"token comment"}},[s._v("-- начать транзакцию")]),s._v("\n\n"),a("span",{attrs:{class:"token comment"}},[s._v("-- действия в транзакции")]),s._v("\n"),a("span",{attrs:{class:"token keyword"}},[s._v("DELETE")]),s._v(" OrderItems "),a("span",{attrs:{class:"token keyword"}},[s._v("WHERE")]),s._v(" order_num "),a("span",{attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),a("span",{attrs:{class:"token number"}},[s._v("33")]),s._v("\n"),a("span",{attrs:{class:"token keyword"}},[s._v("DELETE")]),s._v(" Orders "),a("span",{attrs:{class:"token keyword"}},[s._v("WHERE")]),s._v(" order_num "),a("span",{attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),a("span",{attrs:{class:"token number"}},[s._v("33")]),s._v("\n\n"),a("span",{attrs:{class:"token keyword"}},[s._v("COMMIT")]),s._v(" "),a("span",{attrs:{class:"token keyword"}},[s._v("TRANSACTION")]),s._v(" "),a("span",{attrs:{class:"token comment"}},[s._v("-- подтв. транзакцию")]),s._v("\n")])])]),a("h6",{attrs:{id:"пример-транзакции"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#пример-транзакции","aria-hidden":"true"}},[s._v("#")]),s._v(" Пример транзакции")]),s._v(" "),a("div",{staticClass:"language-sql extra-class"},[a("pre",{pre:!0,attrs:{class:"language-sql"}},[a("code",[a("span",{attrs:{class:"token keyword"}},[s._v("BEGIN")]),s._v(" "),a("span",{attrs:{class:"token keyword"}},[s._v("TRANSACTION")]),s._v(" "),a("span",{attrs:{class:"token comment"}},[s._v("-- начать транзакцию")]),s._v("\n\n"),a("span",{attrs:{class:"token keyword"}},[s._v("INSERT")]),s._v(" "),a("span",{attrs:{class:"token keyword"}},[s._v("INTO")]),s._v(" Customers "),a("span",{attrs:{class:"token punctuation"}},[s._v("(")]),s._v("cust_id"),a("span",{attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" cust_name"),a("span",{attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),a("span",{attrs:{class:"token keyword"}},[s._v("VALUES")]),s._v(" "),a("span",{attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{attrs:{class:"token number"}},[s._v("1928")]),a("span",{attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),a("span",{attrs:{class:"token string"}},[s._v("'Gerdino'")]),a("span",{attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n\n"),a("span",{attrs:{class:"token keyword"}},[s._v("SAVE")]),s._v(" "),a("span",{attrs:{class:"token keyword"}},[s._v("TRANSACTION")]),s._v(" StartOrder "),a("span",{attrs:{class:"token comment"}},[s._v("-- сохранили точку")]),s._v("\n\n"),a("span",{attrs:{class:"token keyword"}},[s._v("INSERT")]),s._v(" "),a("span",{attrs:{class:"token keyword"}},[s._v("INTO")]),s._v(" Orders "),a("span",{attrs:{class:"token punctuation"}},[s._v("(")]),s._v("order_num"),a("span",{attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" order_date"),a("span",{attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" cust_id"),a("span",{attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),a("span",{attrs:{class:"token keyword"}},[s._v("VALUES")]),s._v(" "),a("span",{attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{attrs:{class:"token number"}},[s._v("33")]),a("span",{attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),a("span",{attrs:{class:"token string"}},[s._v("'05.25.2020'")]),a("span",{attrs:{class:"token punctuation"}},[s._v(",")]),a("span",{attrs:{class:"token number"}},[s._v("2126")]),a("span",{attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n\n"),a("span",{attrs:{class:"token comment"}},[s._v('-- если ошибка не равно 0, то откатиться то точки сохранения "StartOrder"')]),s._v("\n"),a("span",{attrs:{class:"token keyword"}},[s._v("IF")]),s._v(" @"),a("span",{attrs:{class:"token variable"}},[s._v("@ERROR")]),s._v(" "),a("span",{attrs:{class:"token operator"}},[s._v("<>")]),s._v(" "),a("span",{attrs:{class:"token number"}},[s._v("0")]),s._v(" "),a("span",{attrs:{class:"token keyword"}},[s._v("ROLLBACK")]),s._v(" "),a("span",{attrs:{class:"token keyword"}},[s._v("TRANSACTION")]),s._v(" StartOrder\n\n"),a("span",{attrs:{class:"token keyword"}},[s._v("INSERT")]),s._v(" "),a("span",{attrs:{class:"token keyword"}},[s._v("INTO")]),s._v(" OrderItems "),a("span",{attrs:{class:"token punctuation"}},[s._v("(")]),s._v("order_num"),a("span",{attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" order_item"),a("span",{attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" prod_id"),a("span",{attrs:{class:"token punctuation"}},[s._v(",")]),s._v("quantity"),a("span",{attrs:{class:"token punctuation"}},[s._v(",")]),s._v("item_price"),a("span",{attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),a("span",{attrs:{class:"token keyword"}},[s._v("VALUES")]),s._v(" "),a("span",{attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{attrs:{class:"token number"}},[s._v("33")]),a("span",{attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n"),a("span",{attrs:{class:"token number"}},[s._v("3232")]),a("span",{attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),a("span",{attrs:{class:"token number"}},[s._v("20100")]),a("span",{attrs:{class:"token punctuation"}},[s._v(",")]),a("span",{attrs:{class:"token number"}},[s._v("32")]),a("span",{attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),a("span",{attrs:{class:"token number"}},[s._v("44.12")]),a("span",{attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n\n"),a("span",{attrs:{class:"token comment"}},[s._v('-- если ошибка не равно 0, то откатиться то точки сохранения "StartOrder"')]),s._v("\n"),a("span",{attrs:{class:"token keyword"}},[s._v("IF")]),s._v(" @"),a("span",{attrs:{class:"token variable"}},[s._v("@ERROR")]),s._v(" "),a("span",{attrs:{class:"token operator"}},[s._v("<>")]),s._v(" "),a("span",{attrs:{class:"token number"}},[s._v("0")]),s._v(" "),a("span",{attrs:{class:"token keyword"}},[s._v("ROLLBACK")]),s._v(" "),a("span",{attrs:{class:"token keyword"}},[s._v("TRANSACTION")]),s._v(" StartOrder\n\n"),a("span",{attrs:{class:"token keyword"}},[s._v("INSERT")]),s._v(" "),a("span",{attrs:{class:"token keyword"}},[s._v("INTO")]),s._v(" OrderItems "),a("span",{attrs:{class:"token punctuation"}},[s._v("(")]),s._v("order_num"),a("span",{attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" order_item"),a("span",{attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" prod_id"),a("span",{attrs:{class:"token punctuation"}},[s._v(",")]),s._v("quantity"),a("span",{attrs:{class:"token punctuation"}},[s._v(",")]),s._v("item_price"),a("span",{attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),a("span",{attrs:{class:"token keyword"}},[s._v("VALUES")]),s._v(" "),a("span",{attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{attrs:{class:"token number"}},[s._v("34")]),a("span",{attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n"),a("span",{attrs:{class:"token number"}},[s._v("3264")]),a("span",{attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),a("span",{attrs:{class:"token number"}},[s._v("20101")]),a("span",{attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),a("span",{attrs:{class:"token number"}},[s._v("3")]),a("span",{attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),a("span",{attrs:{class:"token number"}},[s._v("11.12")]),a("span",{attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n\n"),a("span",{attrs:{class:"token comment"}},[s._v('-- если ошибка не равно 0, то откатиться то точки сохранения "StartOrder"')]),s._v("\n"),a("span",{attrs:{class:"token keyword"}},[s._v("IF")]),s._v(" @"),a("span",{attrs:{class:"token variable"}},[s._v("@ERROR")]),s._v(" "),a("span",{attrs:{class:"token operator"}},[s._v("<>")]),s._v(" "),a("span",{attrs:{class:"token number"}},[s._v("0")]),s._v(" "),a("span",{attrs:{class:"token keyword"}},[s._v("ROLLBACK")]),s._v(" "),a("span",{attrs:{class:"token keyword"}},[s._v("TRANSACTION")]),s._v(" StartOrder\n\n"),a("span",{attrs:{class:"token keyword"}},[s._v("COMMIT")]),s._v(" "),a("span",{attrs:{class:"token keyword"}},[s._v("TRANSACTION")]),s._v(" "),a("span",{attrs:{class:"token comment"}},[s._v("-- подтв. транзакцию")]),s._v("\n")])])]),a("h6",{attrs:{id:"транзакция-между-банками"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#транзакция-между-банками","aria-hidden":"true"}},[s._v("#")]),s._v(" Транзакция между банками")]),s._v(" "),a("div",{staticClass:"language-sql extra-class"},[a("pre",{pre:!0,attrs:{class:"language-sql"}},[a("code",[a("span",{attrs:{class:"token keyword"}},[s._v("BEGIN")]),s._v(" "),a("span",{attrs:{class:"token keyword"}},[s._v("TRANSACTION")]),s._v(" transfer\n\n"),a("span",{attrs:{class:"token keyword"}},[s._v("INSERT")]),s._v(" "),a("span",{attrs:{class:"token keyword"}},[s._v("INTO")]),s._v(" b1"),a("span",{attrs:{class:"token punctuation"}},[s._v("(")]),s._v("id"),a("span",{attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" sum"),a("span",{attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),a("span",{attrs:{class:"token keyword"}},[s._v("VALUES")]),a("span",{attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{attrs:{class:"token number"}},[s._v("4")]),a("span",{attrs:{class:"token punctuation"}},[s._v(",")]),a("span",{attrs:{class:"token number"}},[s._v("0")]),a("span",{attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n"),a("span",{attrs:{class:"token keyword"}},[s._v("INSERT")]),s._v(" "),a("span",{attrs:{class:"token keyword"}},[s._v("INTO")]),s._v(" b2"),a("span",{attrs:{class:"token punctuation"}},[s._v("(")]),s._v("id"),a("span",{attrs:{class:"token punctuation"}},[s._v(",")]),s._v("sum"),a("span",{attrs:{class:"token punctuation"}},[s._v(")")]),s._v("  "),a("span",{attrs:{class:"token keyword"}},[s._v("VALUES")]),a("span",{attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{attrs:{class:"token number"}},[s._v("54")]),a("span",{attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),a("span",{attrs:{class:"token number"}},[s._v("100")]),a("span",{attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n\n"),a("span",{attrs:{class:"token comment"}},[s._v('-- если ошибка не равно 0, то откатиться то точки сохранения "transfer", В НАЧАЛО')]),s._v("\n"),a("span",{attrs:{class:"token comment"}},[s._v("-- иначе подвтердить транзакцию")]),s._v("\n"),a("span",{attrs:{class:"token keyword"}},[s._v("IF")]),s._v(" @"),a("span",{attrs:{class:"token variable"}},[s._v("@ERROR")]),s._v(" "),a("span",{attrs:{class:"token operator"}},[s._v("<>")]),s._v(" "),a("span",{attrs:{class:"token number"}},[s._v("0")]),s._v(" "),a("span",{attrs:{class:"token keyword"}},[s._v("rollback")]),s._v(" "),a("span",{attrs:{class:"token keyword"}},[s._v("transaction")]),s._v(" transfer\n"),a("span",{attrs:{class:"token keyword"}},[s._v("ELSE")]),s._v(" "),a("span",{attrs:{class:"token keyword"}},[s._v("COMMIT")]),s._v(" "),a("span",{attrs:{class:"token keyword"}},[s._v("TRANSACTION")]),s._v(" transfer\n\n"),a("span",{attrs:{class:"token keyword"}},[s._v("SELECT")]),s._v(" "),a("span",{attrs:{class:"token operator"}},[s._v("*")]),s._v(" "),a("span",{attrs:{class:"token keyword"}},[s._v("FROM")]),s._v(" b1\n"),a("span",{attrs:{class:"token keyword"}},[s._v("SELECT")]),s._v(" "),a("span",{attrs:{class:"token operator"}},[s._v("*")]),s._v(" "),a("span",{attrs:{class:"token keyword"}},[s._v("FROM")]),s._v(" b2\n")])])])])}],!1,null,null,null);r.options.__file="transaction.md";t.default=r.exports}}]);